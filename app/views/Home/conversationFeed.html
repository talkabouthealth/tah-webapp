#{extends 'main.html' /}
	<style type="text/css">
		body { background:transparent url(/public/images/inner_bgmt.gif) repeat-x scroll center top; }
		
		#innermiddlearea { padding-top: 10px }
		
		#mask { background-color:#e6e6e6; }
		
		.latestactivity, .latestactivity1 { width: auto }
		.latestactivity a, .latestactivity1 a { width: auto; padding-left: 8px; padding-right: 8px }
		.latestactivity a:hover, .latestactivity1 a:hover { width: auto; padding-left: 8px; padding-right: 8px }
		
		.inline_form { display:none; }
	</style>
	
	<script type="text/javascript" src="/public/plugins/jquery.truncatable.js" ></script>
	<script type="text/javascript" src="/public/plugins/jquery.inline-edit.js" ></script>
	<script type="text/javascript">
		var feedsPerPage = ${logic.FeedsLogic.FEEDS_PER_PAGE};
	
		$(document).ready(function() {
			$(".followTopicLink").live('click', function() {
				var convoId = $(this).attr("rel");
				if ($(this).html().indexOf("Unfollow") != -1) {
					$(this).html("Follow");
				}
				else {
					$(this).html("Unfollow");
				}
				$.post("@{Conversations.follow()}", 
	  				{ convoId: convoId},
	  				function(data) {
	  					//...
	  				}
	  			);
	  			return false;
			});

			$('.moretext').truncatable({ limit: 160, more: '... more', less: true, hideText: '' });

			$(".tabLink").click(function() {
   				$(".latestactivity").removeClass("latestactivity").addClass("latestactivity1"); //Remove any "active" class
   				$(this).parent().removeClass("latestactivity1").addClass("latestactivity"); //Add "active" class to selected tab
   				var id = $(this).attr("id");
   				$(".tabContent").hide(); //Hide all tab content
   				$("#"+id+"Content").fadeIn(); //Fade in the active content
   				return false;
   			});

			$('.inline-edit').inlineEdit( { hover: ''} );
		});

		//for comments/replies in feed
		function showReplyForm(commentId) {
			$("#reply"+commentId+" .inline_display").hide();
			$("#reply"+commentId+" .inline_form").show();
			$("#reply"+commentId).show();
			return false;
		}

		//saveProfileComment(String profileTalkerId, String parentId, String text)
   		function saveProfileComment(parentId) {
   	   		var commentText = $("#replytext"+parentId).val();
   			$("#replytext"+parentId).val("");

   			$.post("@{Actions.saveProfileComment2()}", 
  				{ parentId: parentId, text: commentText},
  				function(html) {
  	  				$("#firstcommentmessage").hide();
  					//put comment in the tree
  					if (parentId == '') {
  	  					//add as first element in the top
  						$(html).prependTo($(".commentsarea"));

  	  					//add inline edit for new comment
  						$('.inline-edit').inlineEdit( { hover: ''} );
  					}
  					else {
  						//add as last element in subtree
  						$("#reply"+parentId).before($(html));
  					}
  				}
  			);

   			
  			return false;
   		}
	</script>
		
<div id="managtopic1" style="background:url(/public/images/inner_bgmt.gif); background-repeat:repeat-x;">
  <div id="managtopic">
  	#{include 'header.html' /}
  	<div id="bottom_container">
      	<div class="haderbanner"><div id="innerbanner"></div></div>
        <div id="targetedtherapy">

          <div id="innermiddlearea">
            <div id="mtcover">
              <div id="mtleft">
                <div class="mtcontent">
                  <div class="topipcWraper">
                  	<div style="padding-top: 10px; height: 30px;" class="lacover">
					  <div class="latestactivity"><a href="#" id="latestActivity" class="tabLink">Your Conversation Feed</a></div>
					  <div class="latestactivity1"><a href="#" id="openQuestions" class="tabLink">Community Conversation Feed</a></div>
					  <div class="laborder"></div>
					</div>
					<div class="cb"></div>
					<div>
						<div id="latestActivityContent" class="tabContent">	
							<div class="topic">
		                      <div class="newpage1">Your Conversation Feed</div>
		
		                      <div class="cb"></div>
		                      <div class="joinborder"></div>
		                      <!--mtinputbox-->
		                      <div class="cb"></div>
		                      <div class="topic">
		                        <div id="convoFeedList">
			                    	#{list items: convoFeed, as: 'activity'}
										#{feedActivity activity: activity, talker: talker /}
									#{/list}
									#{else}
										<span class="blacktext16">When you Follow Topics, Conversations, and
											other members, your Conversation Feed will be filled with their updates.</span>
									#{/else}
								</div>
								#{if convoFeed.size() == logic.FeedsLogic.FEEDS_PER_PAGE }
									<div class="replytommentbox" id="convoFeedBtn">
			                          <input type="submit" src="images/seemore.jpg" 
			                          	onclick="return loadMoreFeed('convoFeed');" value=" " class="seemorecom" />
			                        </div>
								#{/if}
		                        <div class="cb"></div>
		                      </div>
		                      <!--newpageCover-->
		                      <div class="cb"></div>
		                    </div> 
						</div>
						<div id="openQuestionsContent" class="tabContent" style="display: none;">
							<div class="topic">
		                      <div class="newpage1">Community Conversation Feed</div>
		
		                      <div class="cb"></div>
		                      <div class="joinborder"></div>
		                      <!--mtinputbox-->
		                      <div class="cb"></div>
		                      <div class="topic">
		                        <div id="communityFeedList">
			                    	#{list items: communityFeed, as: 'activity'}
										#{feedActivity activity: activity, talker: talker /}
									#{/list}
								</div>
								#{if communityFeed.size() == logic.FeedsLogic.FEEDS_PER_PAGE }
									<div class="replytommentbox" id="communityFeedBtn">
			                          <input type="submit" src="images/seemore.jpg" 
			                          	onclick="return loadMoreFeed('communityFeed');" value=" " class="seemorecom" />
			                        </div>
								#{/if}
		                        <div class="cb"></div>
		                      </div>
		                      <!--newpageCover-->
		                      <div class="cb"></div>
		                    </div> 
						</div>
					</div>
                    
                    <div class="cb"></div>
                  </div>
                  <!--topipcWraper-->

                  <div class="cb"></div>
                </div>
                <!--mtcontent-->
                <div class="cb"></div>
              </div>
              <!--mtleft-->
            
            #{ set currentPage = 'convoFeed' /}
            #{ include 'right.html' /}
            
            <!--mtright-->
            <div class="cb"></div>
          </div>
          <!--mtcover-->
          <div class="cb"></div>

        </div>
        <div id="signupright"></div>
      </div>
    </div>
  </div>